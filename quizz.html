<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quiz Complet – Examen Blanc</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f4f6; /* Tailwind gray-100 */
    }
    .quiz-page {
      display: none;
      animation: fadeIn 0.5s ease-in-out;
    }
    .quiz-page.active {
      display: block;
    }
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .question-block {
      margin-bottom: 1.5rem;
      padding: 1.25rem; /* p-5 */
      border: 1px solid #e5e7eb; /* Tailwind gray-200 */
      border-radius: 0.5rem; /* rounded-lg */
      background-color: white;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1),
        0 1px 2px 0 rgba(0, 0, 0, 0.06); /* shadow-md */
    }
    .result {
      margin-top: 0.75rem; /* mt-3 */
      font-weight: 600; /* font-semibold */
      font-size: 0.875rem; /* text-sm */
    }
    .result.text-green-700 {
      color: #047857; /* Tailwind green-700 */
    }
    .result.text-red-700 {
      color: #b91c1c; /* Tailwind red-700 */
    }

    input[type='radio'] {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      width: 1.25em;
      height: 1.25em;
      border: 2px solid #6b7280; /* Tailwind gray-500 */
      border-radius: 50%;
      outline: none;
      cursor: pointer;
      margin-right: 0.5em;
      position: relative;
      top: 0.2em;
    }
    input[type='radio']:checked {
      border-color: #2563eb; /* Tailwind blue-600 */
      background-color: #2563eb; /* Tailwind blue-600 */
    }
    input[type='radio']:checked::before {
      content: '';
      display: block;
      width: 0.6em;
      height: 0.6em;
      background-color: white;
      border-radius: 50%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    label.flex {
      cursor: pointer;
    }

    #notificationArea {
      position: fixed;
      top: 1.25rem;
      right: 1.25rem;
      padding: 1rem;
      border-radius: 0.375rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
        0 4px 6px -2px rgba(0, 0, 0, 0.05);
      z-index: 100;
      display: none;
      color: white;
      font-weight: 500;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.6);
      animation: fadeInModal 0.3s ease-out;
    }
    .modal-content {
      background-color: #fefefe;
      margin: 10% auto;
      padding: 2rem;
      border: 1px solid #888;
      width: 90%;
      max-width: 600px;
      border-radius: 0.75rem; /* rounded-xl */
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1),
        0 10px 10px -5px rgba(0, 0, 0, 0.04); /* shadow-2xl */
    }
    .modal-header {
      padding-bottom: 1rem;
      margin-bottom: 1rem;
      border-bottom: 1px solid #e5e7eb; /* Tailwind gray-200 */
    }
    .modal-body {
      max-height: 60vh;
      overflow-y: auto;
    }
    .close-button {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }
    .close-button:hover,
    .close-button:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }
    @keyframes fadeInModal {
      from {
        opacity: 0;
        transform: scale(0.95);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Styles for category details in stats modal */
    .category-detail summary {
      cursor: pointer;
      padding: 0.5rem 0;
      font-weight: 600;
      color: #374151; /* Tailwind gray-700 */
      border-bottom: 1px solid #e5e7eb;
    }
    .category-detail summary:hover {
      color: #1f2937; /* Tailwind gray-900 */
    }
    .category-detail ul {
      list-style-type: disc;
      padding-left: 1.5rem;
      margin-top: 0.5rem;
    }
    .category-detail li {
      margin-bottom: 0.25rem;
      color: #4b5563; /* Tailwind gray-600 */
    }
  </style>
</head>

<body class="p-4 md:p-8">
  <div id="notificationArea"></div>

  <div class="container mx-auto max-w-3xl bg-white shadow-xl rounded-xl p-6 md:p-8">
    <header class="text-center mb-8 relative">
      <h1
        id="mainQuizTitle"
        class="text-4xl font-bold text-blue-700"
      >
        Examen Blanc Quiz Interactif
      </h1>
      <p id="mainQuizSubtitle" class="text-gray-600 mt-2">
        Testez vos connaissances avec ces 100 questions.
      </p>

      <button
        id="langToggleButton"
        onclick="toggleLanguage()"
        class="absolute top-0 right-0 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md text-sm transition-colors duration-150"
      >
        Switch to English
      </button>

      <div class="mt-4 flex justify-center space-x-4">
        <button
          id="testModeButton"
          onclick="switchMode('test')"
          class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-colors duration-150"
        >
          Mode Examen
        </button>
        <button
          id="learningModeButton"
          onclick="switchMode('learn')"
          class="bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-colors duration-150"
        >
          Mode Apprentissage
        </button>
      </div>

      <div id="shuffleControls" class="mt-4 flex items-center justify-center space-x-2">
        <label class="flex items-center space-x-2">
          <input type="checkbox" id="shuffleToggle" checked />
          <span id="shuffleLabel" class="text-gray-700">Ordre par défaut</span>
        </label>
        <button
          id="shuffleButton"
          class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-1 px-4 rounded disabled:opacity-50 disabled:cursor-not-allowed"
          disabled
        >
          Mélanger les questions
        </button>
      </div>
    </header>

    <div id="testModeContainer">
      <div id="page-0" class="quiz-page active">
        <h2
          id="pageTitle-0"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 1 – 10
        </h2>
      </div>
      <div id="page-1" class="quiz-page">
        <h2
          id="pageTitle-1"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 11 – 20
        </h2>
      </div>
      <div id="page-2" class="quiz-page">
        <h2
          id="pageTitle-2"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 21 – 30
        </h2>
      </div>
      <div id="page-3" class="quiz-page">
        <h2
          id="pageTitle-3"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 31 – 40
        </h2>
      </div>
      <div id="page-4" class="quiz-page">
        <h2
          id="pageTitle-4"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 41 – 50
        </h2>
      </div>
      <div id="page-5" class="quiz-page">
        <h2
          id="pageTitle-5"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 51 – 60
        </h2>
      </div>
      <div id="page-6" class="quiz-page">
        <h2
          id="pageTitle-6"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 61 – 70
        </h2>
      </div>
      <div id="page-7" class="quiz-page">
        <h2
          id="pageTitle-7"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 71 – 80
        </h2>
      </div>
      <div id="page-8" class="quiz-page">
        <h2
          id="pageTitle-8"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 81 – 90
        </h2>
      </div>
      <div id="page-9" class="quiz-page">
        <h2
          id="pageTitle-9"
          class="page-title text-2xl font-semibold mb-6 text-gray-800 border-b pb-2"
        >
          Questions 91 – 100
        </h2>
      </div>

      <footer class="mt-10 pt-6 border-t border-gray-300">
        <div class="navigation-controls flex justify-between items-center mb-4">
          <button
            id="prevButton"
            onclick="navigatePage(-1)"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"
          >
            Précédent
          </button>
          <span id="pageIndicator" class="text-gray-700 font-medium text-lg"
            >Page 1 / 10</span
          >
          <button
            id="nextButton"
            onclick="navigatePage(1)"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-150"
          >
            Suivant
          </button>
        </div>
        <div class="mt-6 space-y-3 md:space-y-0 md:flex md:space-x-3">
          <button
            id="viewResultsButton"
            onclick="showFinalResultsModal()"
            class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-lg w-full md:w-auto shadow-md transition-colors duration-150"
          >
            Voir les résultats finaux
          </button>
          <button
            id="resetAllButton"
            onclick="resetAllAnswers()"
            class="bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-6 rounded-lg w-full md:w-auto shadow-md transition-colors duration-150"
          >
            Réinitialiser toutes les réponses
          </button>
        </div>
      </footer>
    </div>

    <div id="learningModeContainer" style="display: none;">
      <div class="mt-8 pt-6 border-t border-gray-300">
        <h3 id="learningToolsTitle" class="text-2xl font-semibold mb-4 text-center text-gray-700">Outils d'Apprentissage</h3>
        <div class="space-y-3 md:space-y-0 md:flex md:space-x-3 md:justify-center">
          <button
            id="generatePracticeCardButton"
            onclick="generatePracticeCard()"
            class="bg-teal-500 hover:bg-teal-600 text-white font-semibold py-3 px-6 rounded-lg w-full md:w-auto shadow-md transition-colors duration-150"
          >
            Générer une Carte de Pratique (10 Q)
          </button>
          <button
            id="viewStatsButton"
            onclick="showPerformanceStatsModal()"
            class="bg-sky-500 hover:bg-sky-600 text-white font-semibold py-3 px-6 rounded-lg w-full md:w-auto shadow-md transition-colors duration-150"
          >
            Voir les Statistiques de Performance
          </button>
        </div>
      </div>

      <div id="practiceQuestionsDisplayArea" class="mt-8">
        </div>

      <div class="mt-6 text-center space-y-3">
          <button
            id="checkPracticeCardButton"
            onclick="checkPracticeCardAnswers()"
            class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md"
            style="display: none;"
          >
            Vérifier la Carte
          </button>
          <p id="practiceCardScoreText" class="text-lg font-semibold text-gray-800"></p>
          <button
            id="generateNewPracticeCardButton"
            onclick="generatePracticeCard()"
            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md mt-4"
            style="display: none;"
          >
            Générer une Nouvelle Carte
          </button>
      </div>
    </div>

  </div>

  <div id="finalResultsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="close-button" onclick="closeFinalResultsModal()">&times;</span>
        <h2 id="finalResultsTitle" class="text-2xl font-bold text-gray-800">
          Résultats Finaux
        </h2>
      </div>
      <div id="finalResultsBody" class="modal-body space-y-3">
        </div>
      <div class="mt-6 text-center">
        <p id="overallScoreText" class="text-xl font-bold text-blue-700"></p>
      </div>
    </div>
  </div>

  <div id="performanceStatsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="close-button" onclick="closePerformanceStatsModal()">×</span>
        <h2 id="performanceStatsTitle" class="text-2xl font-bold text-gray-800">Statistiques de Performance</h2>
      </div>
      <div id="performanceStatsBody" class="modal-body space-y-2">
        </div>
    </div>
  </div>

  <div id="customConfirmationModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="close-button" onclick="closeConfirmationModal()">&times;</span>
        <h2 class="text-2xl font-bold text-gray-800">Confirmation</h2>
      </div>
      <div id="confirmationModalBody" class="modal-body">
        <p class="text-gray-700"></p>
      </div>
      <div class="mt-6 text-center space-x-4">
        <button id="confirmYes" class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md">Oui</button>
        <button id="confirmNo" class="bg-gray-400 hover:bg-gray-500 text-white font-semibold py-2 px-4 rounded-lg shadow-md">Non</button>
      </div>
    </div>
  </div>

  <script>
    // ––– Language and UI Strings –––
    let currentLanguage = 'fr';
    const uiStrings = {
      fr: {
        pageTitleDoc: 'Quiz Complet – Examen Blanc',
        mainQuizTitle: 'Examen Blanc Quiz Interactif',
        mainQuizSubtitle: 'Testez vos connaissances avec ces 100 questions.',
        langToggleButton: 'Switch to English',
        trueLabel: 'Vrai',
        falseLabel: 'Faux',
        correctFeedback: 'Correct !',
        incorrectFeedbackPrefix: 'Faux ! La bonne réponse était ',
        selectAnswerPrompt: 'Veuillez sélectionner une réponse.',
        checkAnswersButton: 'Vérifier les réponses',
        pageIndicatorPrefix: 'Page',
        prevButton: 'Précédent',
        nextButton: 'Suivant',
        resetButton: 'Réinitialiser toutes les réponses',
        viewResultsButton: 'Voir les résultats finaux',
        finalResultsTitle: 'Résultats Finaux',
        overallScoreLabel: 'Score Total',
        scoreForPageLabel: 'Score pour cette page',
        allAnswersResetMsg: 'Toutes les réponses ont été réinitialisées.',
        questionsLabel: 'Questions',
        noResultsYet:
          'Aucun résultat à afficher. Veuillez compléter des pages du quiz.',
        defaultLabel: 'Ordre par défaut',
        shuffleButton: 'Mélanger les questions',
        learningToolsTitle: "Outils d'Apprentissage",
        generatePracticeCardButton: "Générer une Carte de Pratique (10 Q)", // Changed to 10 Q
        viewStatsButton: "Voir les Statistiques de Performance",
        practiceCardTitle: "Carte de Pratique",
        checkPracticeCardButton: "Vérifier la Carte",
        performanceStatsTitle: "Statistiques de Performance",
        categoryUnseen: "Non vues",
        categoryNewLearning: "Nouvelles en apprentissage", // New category label
        categoryLearning: "En apprentissage",
        categoryMastered: "Maîtrisées",
        categoryProblematic: "Problématiques",
        questionsInCategory: "questions dans cette catégorie",
        totalCorrect: "Total Correct",
        totalIncorrect: "Total Incorrect",
        performanceDataReset: "Données de performance réinitialisées.",
        confirmResetPerformance: "Êtes-vous sûr de vouloir réinitialiser toutes les données de performance des questions ? Cette action est irréversible.",
        testModeButton: "Mode Examen",
        learningModeButton: "Mode Apprentissage",
        generateNewPracticeCardButton: "Générer une Nouvelle Carte"
      },
      en: {
        pageTitleDoc: 'Complete Quiz – Mock Exam',
        mainQuizTitle: 'Interactive Mock Exam Quiz',
        mainQuizSubtitle: 'Test your knowledge with these 100 questions.',
        langToggleButton: 'Passer en Français',
        trueLabel: 'True',
        falseLabel: 'False',
        correctFeedback: 'Correct!',
        incorrectFeedbackPrefix: 'Wrong! The correct answer was ',
        selectAnswerPrompt: 'Please select an answer.',
        checkAnswersButton: 'Check Answers',
        pageIndicatorPrefix: 'Page',
        prevButton: 'Previous',
        nextButton: 'Next',
        resetButton: 'Reset All Answers',
        viewResultsButton: 'View Final Results',
        finalResultsTitle: 'Final Results',
        overallScoreLabel: 'Total Score',
        scoreForPageLabel: 'Score for this page',
        allAnswersResetMsg: 'All answers have been reset.',
        questionsLabel: 'Questions',
        noResultsYet:
          'No results to display yet. Please complete some quiz pages.',
        defaultLabel: 'Default order',
        shuffleButton: 'Shuffle Questions',
        learningToolsTitle: "Learning Tools",
        generatePracticeCardButton: "Generate Practice Card (10 Q)", // Changed to 10 Q
        viewStatsButton: "View Performance Stats",
        practiceCardTitle: "Practice Card",
        checkPracticeCardButton: "Check Card Answers",
        performanceStatsTitle: "Performance Statistics",
        categoryUnseen: "Unseen",
        categoryNewLearning: "New Learning", // New category label
        categoryLearning: "Learning",
        categoryMastered: "Mastered",
        categoryProblematic: "Problematic",
        questionsInCategory: "questions in this category",
        totalCorrect: "Total Correct",
        totalIncorrect: "Total Incorrect",
        performanceDataReset: "Performance data has been reset.",
        confirmResetPerformance: "Are you sure you want to reset all question performance data? This action cannot be undone.",
        testModeButton: "Test Mode",
        learningModeButton: "Learning Mode",
        generateNewPracticeCardButton: "Generate New Card"
      }
    };

    // ––– Quiz Data (Bilingual) –––
    // Each object has: qNum (1–100), text: {fr: '…', en: '…'}, answer: 'true' or 'false'
    const allQuizData = [
      // Page 1 (Q1–10)
      {
        qNum: 1,
        text: {
          fr:
            "L’utilisation des indices de persuasion est plus efficace lorsque l’interlocuteur est fatigué.",
          en: "The use of persuasive cues is more effective when the interlocutor is tired."
        },
        answer: 'true'
      },
      {
        qNum: 2,
        text: {
          fr:
            "Le biais rétrospectif s’explique par le fait que les individus surestiment rétrospectivement l’apparition d’un événement une fois que l’événement est survenu.",
          en:
            "Hindsight bias is explained by the fact that individuals retrospectively overestimate the occurrence of an event once it has taken place."
        },
        answer: 'false'
      },
      {
        qNum: 3,
        text: {
          fr:
            "Une des principales caractéristiques de la méthode scientifique est que les résultats d’une étude ne doivent pas être falsifiables.",
          en:
            "One of the main characteristics of the scientific method is that the results of a study must be falsifiable."
        },
        answer: 'false'
      },
      {
        qNum: 4,
        text: {
          fr:
            "La diffusion de la responsabilité survient fréquemment dans les structures holacratiques.",
          en: "Diffusion of responsibility frequently occurs in holacratic structures."
        },
        answer: 'true'
      },
      {
        qNum: 4.1, // (to keep qNum unique if needed, but here qNum always from 1–100)
        text: {
          fr:
            "Avoir un comportement de dominance permet d’influencer autrui et ce type de pouvoir s’appelle pouvoir légitime.",
          en:
            "Dominant behavior allows one to influence others, and this type of power is called legitimate power."
        },
        answer: 'false'
      },
      {
        qNum: 5, // Actually Q5
        text: {
          fr:
            "Les deux éléments essentiels qui composent les théories comportementales du leadership sont la production de l’employé et sa considération.",
          en:
            "The two essential elements in behavioral leadership theories are employee production and employee consideration."
        },
        answer: 'false'
      },
      {
        qNum: 6,
        text: {
          fr:
            "Au sein d’une entreprise, une hiérarchie stable favorise la performance du groupe dans toutes les situations.",
          en:
            "Within a company, a stable hierarchy promotes group performance in all situations."
        },
        answer: 'false'
      },
      {
        qNum: 7,
        text: {
          fr:
            "Si votre supérieur vous offre un bonus de fin d’année pour votre excellente performance, on dira qu’il a un pouvoir légitime.",
          en:
            "If your superior offers you a year-end bonus for your excellent performance, we would say he has legitimate power."
        },
        answer: 'false'
      },
      {
        qNum: 8,
        text: {
          fr:
            "La renaissance des théories des traits de personnalité dans les années 2000 n’a été possible que grâce au développement d’une nouvelle technique statistique, la méta-analyse.",
          en:
            "The resurgence of personality trait theories in the 2000s was only made possible by the development of the meta-analysis technique."
        },
        answer: 'false'
      },
      {
        qNum: 9,
        text: {
          fr:
            "Les dirigeants peuvent être à la fois orientés vers les tâches et vers les personnes. Ces deux catégories ne s’excluent pas mutuellement et il est donc possible d’être à la fois l’un et l’autre.",
          en:
            "Leaders can be both task-oriented and people-oriented. These two categories are not mutually exclusive, so it is possible to be both."
        },
        answer: 'true'
      },
      {
        qNum: 10,
        text: {
          fr:
            "Vous êtes à la tête d’un groupe de travail qui cherche des solutions pour le réchauffement climatique. Vous proposez à vos collègues de faire une activité afin de remettre en question les stratégies précédemment utilisées. En faisant cela, vous utilisez un style de leadership transformationnel basé sur la stimulation intellectuelle.",
          en:
            "You are leading a task force looking for solutions to global warming. You suggest your colleagues carry out an activity to challenge previously used strategies. In doing so, you use a transformational leadership style based on intellectual stimulation."
        },
        answer: 'true'
      },

      // Page 2 (Q11–20)
      {
        qNum: 11,
        text: {
          fr:
            "Un leader qui montre de l’optimisme et de l’enthousiasme peut être catégorisé comme utilisant l’influence idéalisée du leadership transformationnel.",
          en:
            "A leader who shows optimism and enthusiasm can be categorized as using the idealized influence of transformational leadership."
        },
        answer: 'false'
      },
      {
        qNum: 12,
        text: {
          fr:
            "Un style de leadership laisser-faire est moins efficace qu’un style de leadership transactionnel actif.",
          en:
            "A laissez-faire leadership style is less effective than an active transactional leadership style."
        },
        answer: 'true'
      },
      {
        qNum: 13,
        text: {
          fr:
            "La validité incrémentielle permet d’améliorer la prédiction des performances du leader.",
          en:
            "Incremental validity improves the prediction of a leader’s performance."
        },
        answer: 'false'
      },
      {
        qNum: 14,
        text: {
          fr:
            "Une leader qui formule une stratégie claire, visionnaire, et dont les objectifs sont ambitieux fait preuve d’un leadership transformationnel.",
          en:
            "A leader who formulates a clear, visionary strategy with ambitious goals demonstrates transformational leadership."
        },
        answer: 'false'
      },
      {
        qNum: 15,
        text: {
          fr:
            "Le leadership instrumental nécessite une attention particulière à l’environnement et aux résultats des subordonnés.",
          en:
            "Instrumental leadership requires close attention to the environment and subordinates’ outcomes."
        },
        answer: 'true'
      },
      {
        qNum: 16,
        text: {
          fr:
            "Le leadership instrumental n’ajoute pas de validité supplémentaire au lien entre le leadership transformationnel et les performances du dirigeant.",
          en:
            "Instrumental leadership does not add incremental validity to the link between transformational leadership and leader performance."
        },
        answer: 'false'
      },
      {
        qNum: 17,
        text: {
          fr:
            "L’efficacité d’un leader est plus élevée lorsqu’il utilise les récompenses contingentes comparé à un style de leadership transformationnel.",
          en:
            "A leader’s effectiveness is higher when using contingent rewards compared to a transformational leadership style."
        },
        answer: 'false'
      },
      {
        qNum: 18,
        text: {
          fr:
            "Lors de l’évaluation des performances d’un leader, il est toujours préférable d’utiliser une évaluation objective plutôt qu’une évaluation subjective.",
          en:
            "When evaluating a leader’s performance, it is always preferable to use an objective assessment rather than a subjective one."
        },
        answer: 'false'
      },
      {
        qNum: 19,
        text: {
          fr:
            "Quand un leader dit : « Si vous gagnez ce client, je vais vous donner la responsabilité du projet… », il utilise les récompenses contingentes dans son style de leadership.",
          en:
            "When a leader says, “If you win this client, I will give you responsibility for the project…,” he is using contingent rewards in his leadership style."
        },
        answer: 'true'
      },
      {
        qNum: 20,
        text: {
          fr:
            "« Je pense que, je pense que, pardon mais euh…, sur le sujet des engrais, l'approche qu'on a, et j'entends ce que vous dites et c'est très juste… » Ceci est un exemple du doute selon le langage impuissant.",
          en:
            "\"I think that, I think that, sorry but um…, on the subject of fertilizers, our approach, and I hear what you’re saying and it’s very true…\" This is an example of doubt in powerless language."
        },
        answer: 'false'
      },

      // Page 3 (Q21–30)
      {
        qNum: 21,
        text: {
          fr:
            "« Si l'on recherche un peu plus d'information, on pourrait peut-être y arriver même si je ne suis pas certain du résultat. » Ceci est un exemple de clause de non-responsabilité selon le langage impuissant.",
          en:
            "\"If we look for a bit more information, we might get there even if I’m not sure of the result.\" This is an example of a disclaimer in powerless language."
        },
        answer: 'true'
      },
      {
        qNum: 22,
        text: {
          fr:
            "Le modèle interactionnel de la communication permet d'expliquer que certaines blagues ne produisent pas du rire chez tous les spectateurs, surtout chez ceux dont l'origine n'est pas similaire à celle de l'oratrice.",
          en:
            "The interactional model of communication explains why some jokes don’t produce laughter in all spectators, especially those whose background isn’t similar to the speaker’s."
        },
        answer: 'false'
      },
      {
        qNum: 23,
        text: {
          fr:
            "Les leaders à succès passent une proportion de leur temps plus grande à prendre des décisions que les leaders ayant le moins de succès.",
          en:
            "Successful leaders spend a larger proportion of their time making decisions than less successful leaders."
        },
        answer: 'true'
      },
      {
        qNum: 24,
        text: {
          fr:
            "Dans une culture à forte contextualisation, un même énoncé a besoin d'indices supplémentaires pour être compris par le récepteur.",
          en:
            "In a high-context culture, the same statement needs additional cues to be understood by the receiver."
        },
        answer: 'true'
      },
      {
        qNum: 25,
        text: {
          fr:
            "« Pour améliorer le quotidien de nombreuses personnes dans le besoin, il faut mettre en place des mesures drastiques. Il faut améliorer la quantité de ressources allouées à cette problématique. Il faut aussi sensibiliser la population et favoriser l'intégration de ces personnes. » Ceci est un exemple de répétition.",
          en:
            "\"To improve the daily lives of many people in need, drastic measures must be put in place. We need to increase the quantity of resources allocated to this issue. We must also raise awareness and promote integration of these people.\" This is an example of repetition."
        },
        answer: 'false'
      },
      {
        qNum: 26,
        text: {
          fr:
            "« Souvenez-vous, souvenez-vous du 5 novembre, de la poudre à canon, des trahisons et conspirations. » Ceci est un exemple d'anecdote.",
          en:
            "\"Remember, remember the 5th of November, gunpowder, treason and plot.\" This is an example of an anecdote."
        },
        answer: 'false'
      },
      {
        qNum: 27,
        text: {
          fr:
            "« Lors de mes voyages au travers des Caraïbes, j'ai rencontré des populations qui n'avaient que très peu de ressources. Pourtant, ces populations parviennent à survivre. Ce n'est pas la quantité qui permet de se développer, mais l'efficience dans l'utilisation des ressources. Si eux y sont arrivés, nous y arriverons aussi. » Ceci est un exemple de confiance vis-à-vis des objectifs.",
          en:
            "\"During my travels across the Caribbean, I met populations with very few resources. Yet those populations manage to survive. It’s not quantity that enables development but efficiency in resource usage. If they succeeded, we can too.\" This is an example of confidence in objectives."
        },
        answer: 'true'
      },
      {
        qNum: 28,
        text: {
          fr:
            "Les suiveurs adoptent la vision du leader dans le cadre d'un leadership charismatique ou transformationnel.",
          en:
            "Followers adopt the leader’s vision under both charismatic and transformational leadership."
        },
        answer: 'true'
      },
      {
        qNum: 29,
        text: {
          fr:
            "Lors de la structuration d'un discours, l'introduction doit comprendre un “appel à l'action”.",
          en:
            "When structuring a speech, the introduction should include a “call to action.”"
        },
        answer: 'false'
      },
      {
        qNum: 30,
        text: {
          fr:
            "Demander une grande faveur puis demander une plus petite faveur est un exemple de la technique du pied dans la porte.",
          en:
            "Asking for a large favor and then requesting a smaller one is an example of the foot-in-the-door technique."
        },
        answer: 'false'
      },

      // Page 4 (Q31–40)
      {
        qNum: 31,
        text: {
          fr:
            "Un employé vient d'apprendre que son département informatique lui fournira un ordinateur pour ses tâches administratives. Il a le choix entre trois modèles dont l'un est recommandé par le département pour sa facilité d'utilisation. Il décide de choisir cet ordinateur sur la base de cette recommandation. L'employé a utilisé une heuristique pour faire son choix.",
          en:
            "An employee just learned that his IT department will provide him with a computer for administrative tasks. He has a choice of three models, one of which is recommended by the department for its ease of use. He chooses that computer based on the department’s recommendation. The employee used a heuristic to make his decision."
        },
        answer: 'true'
      },
      {
        qNum: 32,
        text: {
          fr:
            "Flatter un individu augmente sa propension à coopérer grâce au mécanisme de la voie centrale.",
          en:
            "Flattering an individual increases their propensity to cooperate via the central route of persuasion."
        },
        answer: 'false'
      },
      {
        qNum: 33,
        text: {
          fr:
            "Pour des thématiques qui vous sont importantes, la qualité des arguments est un facteur qui va influencer votre manière de penser.",
          en:
            "For topics that are important to you, argument quality is a factor that will influence your thinking."
        },
        answer: 'true'
      },
      {
        qNum: 34,
        text: {
          fr:
            "Les sites de vente en ligne utilisant une politique de premier arrivé-premier servi utilisent le principe de persuasion du côté unique du produit.",
          en:
            "First-come, first-served online retailers use the principle of product uniqueness to persuade customers to buy."
        },
        answer: 'false'
      },
      {
        qNum: 35,
        text: {
          fr:
            "La technique de persuasion du pied dans la porte se base sur le principe de réciprocité.",
          en:
            "The foot-in-the-door persuasion technique is based on the principle of reciprocity."
        },
        answer: 'false'
      },
      {
        qNum: 36,
        text: {
          fr:
            "Selon le modèle de probabilité d'élaboration, la voie centrale de persuasion est utilisée lorsque les individus ne sont pas motivés ou ne sont pas en mesure de comprendre.",
          en:
            "According to the Elaboration Likelihood Model, the central route of persuasion is used when individuals are motivated and able to process the message. (If they’re not, the peripheral route is used.)"
        },
        answer: 'false'
      },
      {
        qNum: 37,
        text: {
          fr:
            "Selon les principes de la persuasion, la preuve par la masse se base sur les effets de l'obéissance.",
          en:
            "According to persuasion principles, social proof is based on normative influences, not obedience."
        },
        answer: 'false'
      },
      {
        qNum: 38,
        text: {
          fr:
            "Le pouvoir d'autorité est une heuristique de persuasion.",
          en: "Authority power is a heuristic of persuasion."
        },
        answer: 'false'
      },
      {
        qNum: 39,
        text: {
          fr:
            "Un style de leadership authentique est en général plus efficace que les autres styles de leadership vu en cours.",
          en:
            "An authentic leadership style is generally more effective than other leadership styles discussed in class."
        },
        answer: 'false'
      },
      {
        qNum: 40,
        text: {
          fr:
            "L'évaluation défavorable dans un feedback est facilement acceptée lorsque les subordonnés choisissent le candidat.",
          en:
            "Unfavorable feedback is more readily accepted when subordinates choose the candidate."
        },
        answer: 'false'
      },

      // Page 5 (Q41–50)
      {
        qNum: 41,
        text: {
          fr:
            "Le « management by objectives » récompense et sanctionne l'avancée des collaborateurs vers l'objectif.",
          en:
            "\"Management by Objectives\" rewards and sanctions employees’ progress toward goals."
        },
        answer: 'true'
      },
      {
        qNum: 42,
        text: {
          fr:
            "Afin de faciliter un entretien de feedback, on proposera aux collaborateurs d'agender la réunion en amont afin de lui fournir du temps pour se préparer.",
          en:
            "To facilitate a feedback interview, we suggest employees schedule the meeting in advance so they have time to prepare."
        },
        answer: 'true'
      },
      {
        qNum: 43,
        text: {
          fr:
            "La conscience de soi n'existe que chez l'homme et n'est pas possible chez les animaux.",
          en:
            "Self-awareness only exists in humans and is not possible in animals."
        },
        answer: 'false'
      },
      {
        qNum: 44,
        text: {
          fr:
            "Pour un feedback à 360 degrés, le contenu du questionnaire que vous remplissez à votre sujet doit contenir des questions différentes de celles posées aux personnes qui vous évaluent.",
          en:
            "For 360-degree feedback, the questionnaire you fill out about yourself must contain different questions than those asked to people evaluating you."
        },
        answer: 'false'
      },
      {
        qNum: 45,
        text: {
          fr:
            "Dans le cas d'un feedback à 360 degrés, le candidat choisit généralement la personne qui l'évalue.",
          en:
            "In the case of 360-degree feedback, the candidate typically chooses who evaluates them."
        },
        answer: 'true'
      },
      {
        qNum: 46,
        text: {
          fr:
            "L'entretien annuel de collaboration est souvent plus négatif que ce que pensent réellement les supérieurs.",
          en:
            "Annual performance reviews are often more negative than what supervisors actually think."
        },
        answer: 'false'
      },
      {
        qNum: 47,
        text: {
          fr:
            "Lorsque vous donnez un feedback négatif, il est bon de se concentrer sur les intentions de la personne plutôt que sur son comportement.",
          en:
            "When giving negative feedback, it’s better to focus on the person’s intentions rather than their behavior."
        },
        answer: 'false'
      },
      {
        qNum: 48,
        text: {
          fr:
            "C'est le niveau de stress subjectif qui détermine les conséquences négatives, et non le stress objectif.",
          en:
            "It is subjective stress levels that determine negative consequences, not objective stress."
        },
        answer: 'true'
      },
      {
        qNum: 49,
        text: {
          fr:
            "Une employée vient d'être embauchée dans une entreprise. Elle fait face à une charge de travail importante pour laquelle elle n'est pas encore totalement préparée. Elle a l'impression qu'elle gère la situation et n'est pas impactée par la charge de travail. Cette employée ressent donc un stress objectif, mais pas subjectif.",
          en:
            "An employee was just hired. She faces a heavy workload for which she’s not yet prepared. She feels she’s handling it and is not affected by the workload. Therefore, she experiences objective stress but not subjective stress."
        },
        answer: 'false'
      },
      {
        qNum: 50,
        text: {
          fr:
            "Le grit est une compétence qui se développe au cours du temps et permet aux leaders de devenir plus charismatiques si c'est un de leurs buts.",
          en:
            "Grit is a skill that develops over time and allows leaders to become more charismatic if it’s one of their goals."
        },
        answer: 'true'
      },

      // Page 6 (Q51–60)
      {
        qNum: 51,
        text: {
          fr:
            "Considérer que l'apprentissage est une composante essentielle de la progression favorise le développement du grit chez les leaders.",
          en:
            "Believing that learning is essential to progress fosters development of grit in leaders."
        },
        answer: 'true'
      },
      {
        qNum: 52,
        text: {
          fr:
            "Dans des hiérarchies stables, des études montrent que les leaders ressentent moins de stress que les non-leaders et que leurs niveaux de stress physiologique, tels que l'hormone cortisol, sont moins élevés.",
          en:
            "In stable hierarchies, studies show that leaders feel less stress than non-leaders and have lower physiological stress levels (e.g., cortisol)."
        },
        answer: 'true'
      },
      {
        qNum: 53,
        text: {
          fr:
            "Il existe une corrélation entre le « Grit » et l'intelligence.",
          en: "There is a correlation between grit and intelligence."
        },
        answer: 'false'
      },
      {
        qNum: 54,
        text: {
          fr:
            "Un orateur qui voit un modèle du même sexe augmentera son temps de parole. Cela est vrai pour les hommes comme pour les femmes.",
          en:
            "A speaker who sees a same-gender role model will increase their speaking time. This is true for both men and women."
        },
        answer: 'false'
      },
      {
        qNum: 55,
        text: {
          fr:
            "Le self-leadership est une composante du leadership charismatique, car elle permet au leader de motiver les subordonnés.",
          en:
            "Self-leadership is a component of charismatic leadership because it helps the leader motivate subordinates."
        },
        answer: 'false'
      },
      {
        qNum: 56,
        text: {
          fr:
            "Si un individu parvient à reconnaître correctement les traits et états d’autrui, on peut dire qu’il a de la sensibilité interpersonnelle.",
          en:
            "If an individual correctly recognizes others’ traits and states, we say they have interpersonal sensitivity."
        },
        answer: 'true'
      },
      {
        qNum: 57,
        text: {
          fr:
            "Une personne qui parle plus vite, a une voix plus grave, et fait plus d’interruptions est perçue comme quelqu’un avec plus de pouvoir.",
          en:
            "A person who speaks faster, has a deeper voice, and interrupts more is perceived as having more power."
        },
        answer: 'true'
      },
      {
        qNum: 58,
        text: {
          fr:
            "Lors d’une réunion de travail dans votre nouvelle équipe, vous observez qu’une collègue a des contacts visuels fréquents avec les autres participants. D’ailleurs, lorsqu’elle parle, sa voix n’est pas du tout monotone. Vous en concluez qu’elle a du pouvoir dans l’équipe. Vous avez fait preuve de sensibilité interpersonnelle.",
          en:
            "During a team meeting, you notice a colleague making frequent eye contact and using a non-monotone voice. You conclude she has power in the team. That demonstrates interpersonal sensitivity."
        },
        answer: 'false'
      },
      {
        qNum: 59,
        text: {
          fr:
            "L’attractivité, la taille, la voix et la marque des vêtements portés sont utilisés comme indices de statut.",
          en:
            "Attractiveness, size, voice, and brand of clothing worn are used as status indicators."
        },
        answer: 'false'
      },
      {
        qNum: 60,
        text: {
          fr:
            "Selon le modèle de lentille de Brunswick (1956), les premières impressions sont généralement correctes.",
          en:
            "According to Brunswick’s lens model (1956), first impressions are generally accurate."
        },
        answer: 'false'
      },

      // Page 7 (Q61–70)
      {
        qNum: 61,
        text: {
          fr:
            "La tâche de perception interpersonnelle (IPT) et la tâche WIPS sont des tests de performance utilisés pour mesurer le niveau de sensibilité interpersonnelle d'un individu.",
          en:
            "The Interpersonal Perception Task (IPT) and the WIPS task are performance tests used to measure an individual’s level of interpersonal sensitivity."
        },
        answer: 'true'
      },
      {
        qNum: 62,
        text: {
          fr:
            "Selon la théorie des attentes de statut (EST), les attentes concernant la contribution de chaque membre du groupe peuvent créer une prophétie auto-réalisatrice.",
          en:
            "According to Expectation States Theory (EST), expectations about each group member’s contribution can create a self-fulfilling prophecy."
        },
        answer: 'true'
      },
      {
        qNum: 63,
        text: {
          fr:
            "Selon la théorie des attentes de statut (EST), les groupes homogènes forment des hiérarchies en fonction d'indices de statut externes.",
          en:
            "According to EST, homogeneous groups form hierarchies based on external status cues."
        },
        answer: 'false'
      },
      {
        qNum: 64,
        text: {
          fr:
            "Dans un groupe de personnes qui ne se connaissent pas, chaque personne reçoit aléatoirement une casquette avec un trait de personnalité marqué sur la casquette (p.ex. timide, maladroit). Les personnes ne connaissent pas le trait qui est marqué sur leur casquette, mais les autres membres du groupe le voient. Les traits de personnalité marqués sur les casquettes vont amener les membres du groupe à avoir des attentes différentes concernant le comportement de chaque membre du groupe.",
          en:
            "In a group of strangers, each person is randomly given a cap with a personality trait (e.g. shy, awkward). They don’t know their own trait, but the others do. Those traits cause group members to have different expectations about each member’s behavior."
        },
        answer: 'true'
      },
      {
        qNum: 65,
        text: {
          fr:
            "En réalisant un entretien structuré, c’est-à-dire qui respecte la même structure, quels que soient les candidats, on minimise les probabilités d’apparition de biais implicites.",
          en:
            "By conducting a structured interview—using the same structure for every candidate—we minimize the likelihood of implicit bias."
        },
        answer: 'true'
      },
      {
        qNum: 66,
        text: {
          fr:
            "Le racisme est un problème majeur qui s’explique par l’effet d’homogénéisation. Les personnes racistes pensent de la même manière et leur perception de l’exogroupe est homogène.",
          en:
            "Racism is a major problem caused by the homogenization effect. Racist people think similarly and perceive the out-group as homogeneous."
        },
        answer: 'false'
      },
      {
        qNum: 67,
        text: {
          fr:
            "Une perception réduite de la variabilité exogroupe limite le chevauchement réel entre la variabilité exogroupe et endogroupe.",
          en:
            "A reduced perception of out-group variability limits the actual overlap between in-group and out-group variability."
        },
        answer: 'true'
      },
      {
        qNum: 68,
        text: {
          fr:
            "La valence des caractéristiques de l’endogroupe est négative.",
          en: "The valence of in-group characteristics is negative."
        },
        answer: 'false'
      },
      {
        qNum: 69,
        text: {
          fr:
            "Un stéréotype est différent d’un préjugé car les réactions sont différentes : l’une est émotionnelle et l’autre comportementale.",
          en:
            "A stereotype is different from a prejudice because the reactions are different: one is emotional, the other behavioral."
        },
        answer: 'false'
      },
      {
        qNum: 70,
        text: {
          fr:
            "Les stéréotypes sont une heuristique utilisée pour la sélection du personnel lors d’un premier entretien d’embauche.",
          en:
            "Stereotypes are a heuristic used in personnel selection during an initial job interview."
        },
        answer: 'true'
      },

      // Page 8 (Q71–80)
      {
        qNum: 71,
        text: {
          fr:
            "Selon la théorie de l'identité sociale, les stéréotypes peuvent provenir de la catégorisation sociale et de l'identité sociale.",
          en:
            "According to Social Identity Theory, stereotypes can stem from social categorization and social identity."
        },
        answer: 'true'
      },
      {
        qNum: 72,
        text: {
          fr:
            "Il ne suffit pas de connaître les stéréotypes de genre dans notre culture pour qu'ils influencent nos perceptions et nos comportements.",
          en:
            "Merely knowing gender stereotypes in our culture is not enough for them to influence our perceptions and behaviors."
        },
        answer: 'false'
      },
      {
        qNum: 73,
        text: {
          fr:
            "L'exagération et la valence sont des caractéristiques clés des stéréotypes.",
          en:
            "Exaggeration and valence are key characteristics of stereotypes."
        },
        answer: 'true'
      },
      {
        qNum: 74,
        text: {
          fr:
            "Selon la théorie des stéréotypes, les gens perçoivent leur propre groupe comme moins diversifié que d'autres groupes auxquels ils n'appartiennent pas.",
          en:
            "According to stereotype theory, people perceive their own group as less diverse than other groups they don’t belong to."
        },
        answer: 'false'
      },
      {
        qNum: 75,
        text: {
          fr:
            "Il y a toujours une part de vérité derrière les stéréotypes.",
          en: "There is always some truth behind stereotypes."
        },
        answer: 'false'
      },
      {
        qNum: 76,
        text: {
          fr:
            "L'une des manifestations des préjugés implicites est que nous percevons et évaluons le même comportement différemment, en fonction de la personne qui le manifeste.",
          en:
            "One manifestation of implicit bias is that we perceive and evaluate the same behavior differently depending on who displays it."
        },
        answer: 'true'
      },
      {
        qNum: 77,
        text: {
          fr:
            "Le test d'association implicite est une méthode basée sur un questionnaire pour mesurer les préjugés implicites.",
          en:
            "The Implicit Association Test is a questionnaire-based method for measuring implicit biases."
        },
        answer: 'false'
      },
      {
        qNum: 78,
        text: {
          fr:
            "La désindividualisation est un moyen de briser les associations stéréotypées et habituelles et donc de surmonter les préjugés.",
          en:
            "Deindividuation is a way to break stereotypical and habitual associations, thereby overcoming biases."
        },
        answer: 'false'
      },
      {
        qNum: 79,
        text: {
          fr:
            "Au cours du temps, la proportion de répondants considérant les femmes et hommes égaux en termes de compétence à largement augmenté.",
          en:
            "Over time, the proportion of respondents who consider women and men equal in competence has increased significantly."
        },
        answer: 'true'
      },
      {
        qNum: 80,
        text: {
          fr:
            "La proportion de répondants dont l’évaluation de la caractéristique “agency” est stéréotypique des hommes est plus faible en 2020 que celle associée aux femmes en 1945.",
          en:
            "The proportion of respondents whose assessment of the characteristic “agency” is stereotypically male is lower in 2020 than that associated with women in 1945."
        },
        answer: 'false'
      },

      // Page 9 (Q81–90)
      {
        qNum: 81,
        text: {
          fr:
            "Le modèle du lack of fit permet d’expliquer pourquoi une femme serait sous-évaluée lors d’un entretien d’embauche lorsque ce poste concerne une position de manager.",
          en:
            "The Lack-of-Fit model explains why a woman would be undervalued in a job interview when the position is managerial."
        },
        answer: 'true'
      },
      {
        qNum: 82,
        text: {
          fr:
            "La menace du stéréotype influence la catégorie auto-évaluation dans le modèle du lack of fit.",
          en:
            "Stereotype threat influences self-evaluation in the Lack-of-Fit model."
        },
        answer: 'false'
      },
      {
        qNum: 83,
        text: {
          fr:
            "L'explication la plus plausible de l'écart salarial entre les hommes et les femmes est que les femmes ne demandent pas autant d'argent que les hommes.",
          en:
            "The most plausible explanation for the gender wage gap is that women do not negotiate for as much money as men."
        },
        answer: 'false'
      },
      {
        qNum: 84,
        text: {
          fr:
            "Les femmes dirigeantes sont évaluées de manière particulièrement positive lorsqu'elles adoptent un style de leadership masculin.",
          en:
            "Female leaders are evaluated especially positively when they adopt a male leadership style."
        },
        answer: 'false'
      },
      {
        qNum: 85,
        text: {
          fr:
            "Selon le modèle du « Lack of fit », la cohérence ou l'incohérence entre les attributs d'un individu et les attentes ou stéréotypes peut conduire à un comportement d'autolimitation et à la discrimination.",
          en:
            "According to the Lack-of-Fit model, the match or mismatch between an individual’s attributes and expectations or stereotypes can lead to self-limiting behavior and discrimination."
        },
        answer: 'true'
      },
      {
        qNum: 86,
        text: {
          fr:
            "Fournir des explications externes à l'anxiété est un moyen de réduire la menace des stéréotypes.",
          en:
            "Providing external explanations for anxiety is a way to reduce stereotype threat."
        },
        answer: 'true'
      },
      {
        qNum: 87,
        text: {
          fr:
            "Les femmes sont plus susceptibles d'être perçues comme des leaders qui utilisent le style de leadership « Laissez-faire » que les hommes.",
          en:
            "Women are more likely to be perceived as using a laissez-faire leadership style than men."
        },
        answer: 'false'
      },
      {
        qNum: 88,
        text: {
          fr:
            "Deux méta-analyses montrent que la diversité des sexes au sein du conseil d'administration a un effet sur les performances des entreprises.",
          en:
            "Two meta-analyses show that gender diversity on a board of directors affects company performance."
        },
        answer: 'false'
      },
      {
        qNum: 89,
        text: {
          fr:
            "Dans une situation où une leader a un statut élevé, le fait d’avoir du pouvoir ou de ne pas avoir de pouvoir n’a pas d’influence sur les conflits interpersonnels.",
          en:
            "In a situation where a leader has high status, whether they have power or not does not influence interpersonal conflicts."
        },
        answer: 'true'
      },
      {
        qNum: 90,
        text: {
          fr:
            "Les leaders ont tendance à garder à l’esprit les conseils des experts pour améliorer leur compétitivité et augmenter la confiance en leurs propres idées.",
          en:
            "Leaders tend to keep expert advice in mind to improve their competitiveness and increase confidence in their own ideas."
        },
        answer: 'false'
      },

      // Page 10 (Q91–100)
      {
        qNum: 91,
        text: {
          fr:
            "La construction du pouvoir et la corruption qui en découle dépend des opportunités et de la responsabilité de l’institution.",
          en:
            "The construction of power and resulting corruption depend on the opportunities and responsibilities of the institution."
        },
        answer: 'false'
      },
      {
        qNum: 92,
        text: {
          fr:
            "Lors du gala de fin d’année, vous arrivez habillé.e de manière informelle. Vous remarquez dès l’entrée que tous les autres participants sont habillés de manière formelle et vous n’avez pas été tenu au courant. Vous décidez de retourner vous changer pour respecter le code vestimentaire. Vous avez agi de cette manière sous l’influence sociale informative.",
          en:
            "At the year-end gala, you arrive in informal attire. Upon entering, you notice all other attendees are dressed formally, and you weren’t informed. You decide to go back and change to respect the dress code. You acted under informative social influence."
        },
        answer: 'true'
      },
      {
        qNum: 93,
        text: {
          fr:
            "Lors d’une réunion, on vous demande d’aller chercher des verres supplémentaires pour les invités de la société concurrente. Vous devez choisir parmi les verres marrons ou les verres violets et vous ne savez pas quoi faire. Vous choisissez finalement des verres de couleur marron car vous avez vu que la table ne contient que des verres marrons. Vous respectez la norme, il s’agit donc d’une influence sociale normative.",
          en:
            "At a meeting, you’re asked to fetch extra glasses for guests of the rival company. You must choose between brown or purple glasses and aren’t sure. You pick brown because you saw the table has only brown glasses. You’re obeying a norm, so this is normative social influence."
        },
        answer: 'false'
      },
      {
        qNum: 94,
        text: {
          fr:
            "Les personnes orientées vers l'échange se comportent de manière moins égoïste, car elles pensent qu'elles peuvent donner aux autres sans nécessairement toujours recevoir quelque chose en retour.",
          en:
            "People with an exchange orientation behave less selfishly because they believe they can give to others without necessarily always getting something in return."
        },
        answer: 'false'
      },
      {
        qNum: 95,
        text: {
          fr:
            "La déshumanisation peut avoir des effets positifs.",
          en: "Dehumanization can have positive effects."
        },
        answer: 'true'
      },
      {
        qNum: 96,
        text: {
          fr:
            "Le perfectionnisme est un comportement approprié pour les dirigeants, et ceux qui en font preuve sont moins susceptibles de devenir des dirigeants destructeurs.",
          en:
            "Perfectionism is appropriate for leaders, and those who display it are less likely to become destructive leaders."
        },
        answer: 'false'
      },
      {
        qNum: 97,
        text: {
          fr:
            "Le fait d'avoir du pouvoir sans prestige diminue les conflits avec les autres.",
          en:
            "Having power without prestige decreases conflict with others."
        },
        answer: 'false'
      },
      {
        qNum: 98,
        text: {
          fr:
            "Les termes obéissance et conformité renvoient au même phénomène.",
          en:
            "The terms obedience and conformity refer to the same phenomenon."
        },
        answer: 'false'
      },
      {
        qNum: 99,
        text: {
          fr:
            "Vous voulez vous faire couper les cheveux de manière inhabituelle, mais vous craignez que les autres se moquent de vous. Dans ce cas, vous avez été affecté par une influence sociale informative.",
          en:
            "You want to get an unusual haircut but are worried others will mock you. In this case, you have been affected by informative social influence."
        },
        answer: 'false'
      },
      {
        qNum: 100,
        text: {
          fr:
            "Le racisme est un problème majeur qui s’explique par l’effet d’homogénéisation. Les personnes racistes pensent de la même manière et leur perception de l’exogroupe est homogène.",
          en:
            "Racism is a major problem caused by the homogenization effect. Racist people think similarly and perceive the out-group as homogeneous."
        },
        answer: 'false'
      }
    ];

    // ––– Global Variables & Constants –––
    let quizOrder = Array.from({ length: allQuizData.length }, (_, i) => i);
    const originalOrder = Array.from(quizOrder); // [0, 1, 2, …, 99]
    let currentPageIndex = 0;
    const questionsPerPage = 10;
    const numPages = Math.ceil(allQuizData.length / questionsPerPage);
    const pageElements = [];
    let pageScores = Array(numPages)
      .fill(null)
      .map(() => ({ score: 0, totalQuestions: 0, attempted: false }));

    // Global variable to hold performance data for each question
    let performanceData = {};
    // { qNum: { qNumOriginal: 'actualQNum', correctAttempts: 0, incorrectAttempts: 0, category: 'unseen', history: [], lastSeenInQuiz: 0 } }
    // Categories: 'unseen', 'new-learning', 'learning', 'mastered', 'problematic'

    let currentPracticeCardQuestions = []; // To store questions for the current practice card
    const PRACTICE_CARD_SIZE = 10; // Changed to 10 questions per practice card
    let currentMode = 'test'; // 'test' or 'learn'
    let quizCounter = 0; // Tracks how many practice cards have been generated

    // ––– Initialization on DOMContentLoaded –––
    document.addEventListener('DOMContentLoaded', () => {
      // 1) Collect page containers
      for (let i = 0; i < numPages; i++) {
        pageElements.push(document.getElementById(`page-${i}`));
      }

      // Load performance data
      loadPerformanceData();

      // 2) Set up UI text & button labels in the current language
      updateAllUIText();

      // 3) Shuffle checkbox & button
      const shuffleToggle = document.getElementById('shuffleToggle');
      const shuffleButton = document.getElementById('shuffleButton');

      shuffleToggle.addEventListener('change', () => {
        if (shuffleToggle.checked) {
          // Restore default order
          quizOrder = Array.from(originalOrder);
          resetAllAnswers(); // This will now also reset performance data
          renderCurrentPageQuestionsAndFeedback();
          shuffleButton.disabled = true;
        } else {
          // Enable shuffle
          shuffleButton.disabled = false;
        }
      });

      shuffleButton.addEventListener('click', () => {
        // Fisher–Yates shuffle
        for (let i = quizOrder.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [quizOrder[i], quizOrder[j]] = [quizOrder[j], quizOrder[i]];
        }
        resetAllAnswers(); // This will now also reset performance data
        renderCurrentPageQuestionsAndFeedback();
      });

      // 4) Initially render page 0 and set initial mode
      switchMode(currentMode); // Set initial display mode
      updateNavigation();
      renderCurrentPageQuestionsAndFeedback();
    });

    // ––– Language Switching –––
    function toggleLanguage() {
      currentLanguage = currentLanguage === 'fr' ? 'en' : 'fr';
      updateAllUIText();
      renderCurrentPageQuestionsAndFeedback(); // Re-render questions with new language
      // Re-render stats modal if open
      if (document.getElementById('performanceStatsModal').style.display === 'block') {
        showPerformanceStatsModal();
      }
      // If in learning mode, re-render practice card if questions are already displayed
      if (currentMode === 'learn' && currentPracticeCardQuestions.length > 0) {
          renderPracticeCardQuestions(currentPracticeCardQuestions);
      }
    }

    function updateAllUIText() {
      const s = uiStrings[currentLanguage];
      document.title = s.pageTitleDoc;
      document.getElementById('mainQuizTitle').textContent = s.mainQuizTitle;
      document.getElementById('mainQuizSubtitle').textContent =
        s.mainQuizSubtitle;
      document.getElementById('langToggleButton').textContent =
        s.langToggleButton;

      // Mode buttons
      document.getElementById('testModeButton').textContent = s.testModeButton;
      document.getElementById('learningModeButton').textContent = s.learningModeButton;


      // Shuffle labels
      document.getElementById('shuffleLabel').textContent = s.defaultLabel;
      document.getElementById('shuffleButton').textContent =
        s.shuffleButton;

      // Nav button labels
      document.getElementById('prevButton').textContent = s.prevButton;
      document.getElementById('nextButton').textContent = s.nextButton;
      document.getElementById('resetAllButton').textContent = s.resetButton;
      document.getElementById('viewResultsButton').textContent =
        s.viewResultsButton;
      document.getElementById('finalResultsTitle').textContent =
        s.finalResultsTitle;

      // New UI text updates for learning mode
      document.getElementById('learningToolsTitle').textContent = s.learningToolsTitle;
      document.getElementById('generatePracticeCardButton').textContent = s.generatePracticeCardButton;
      document.getElementById('viewStatsButton').textContent = s.viewStatsButton;
      if (document.getElementById('checkPracticeCardButton')) { // Check if element exists before updating
        document.getElementById('checkPracticeCardButton').textContent = s.checkPracticeCardButton;
      }
      if (document.getElementById('generateNewPracticeCardButton')) { // Check if element exists before updating
        document.getElementById('generateNewPracticeCardButton').textContent = s.generateNewPracticeCardButton;
      }
      document.getElementById('performanceStatsTitle').textContent = s.performanceStatsTitle;


      // Page headings
      pageElements.forEach((page, idx) => {
        const titleEl = document.getElementById(`pageTitle-${idx}`);
        if (!titleEl) return;
        const startQ = idx * questionsPerPage + 1;
        const endQ = Math.min((idx + 1) * questionsPerPage, allQuizData.length);
        titleEl.textContent = `${s.questionsLabel} ${startQ} – ${endQ}`;
      });

      updateNavigation();
    }

    // ––– Mode Switching –––
    function switchMode(mode) {
      currentMode = mode;
      const testContainer = document.getElementById('testModeContainer');
      const learnContainer = document.getElementById('learningModeContainer');
      const shuffleControls = document.getElementById('shuffleControls');

      if (mode === 'test') {
        testContainer.style.display = 'block';
        learnContainer.style.display = 'none';
        shuffleControls.style.display = 'flex'; // Show shuffle controls in test mode
        updateNavigation(); // Ensure test mode pagination is updated
        renderCurrentPageQuestionsAndFeedback(); // Ensure questions are rendered
      } else { // 'learn' mode
        testContainer.style.display = 'none';
        learnContainer.style.display = 'block';
        shuffleControls.style.display = 'none'; // Hide shuffle controls in learning mode
        // Clear any previous practice questions when switching to learn mode
        document.getElementById('practiceQuestionsDisplayArea').innerHTML = '';
        document.getElementById('checkPracticeCardButton').style.display = 'none';
        document.getElementById('generateNewPracticeCardButton').style.display = 'none';
        document.getElementById('practiceCardScoreText').textContent = '';
      }
    }


    // ––– Render Current Page (Questions + Buttons) –––
    function renderCurrentPageQuestionsAndFeedback() {
      const pageEl = pageElements[currentPageIndex];
      if (!pageEl) return;

      // 1) Keep the <h2> heading intact
      const heading = pageEl.querySelector('.page-title');
      const headingHTML = heading ? heading.outerHTML : '';

      // 2) Clear entire page, then re-insert heading
      pageEl.innerHTML = headingHTML;

      // 3) Append the 10 question-blocks for this page
      const startIdx = currentPageIndex * questionsPerPage;
      const endIdx = Math.min(startIdx + questionsPerPage, allQuizData.length);

      for (let i = startIdx; i < endIdx; i++) {
        const dataIdx = quizOrder[i]; // index into allQuizData
        const qData = allQuizData[dataIdx];
        pageEl.appendChild(createQuestionElement(qData, 'q')); // Pass 'q' prefix for test mode
      }

      // 4) Append “Check Answers” button + score placeholder
      addCheckButtonAndScoreToPage(currentPageIndex);

      // 5) If page was already attempted, re-run checkAnswers (calculateScore = false)
      if (
        pageScores[currentPageIndex] &&
        pageScores[currentPageIndex].attempted
      ) {
        checkAnswersForPage(
          currentPageIndex,
          startIdx + 1,
          endIdx,
          false
        );
      }
    }

    // ––– Create a Single Question Block (Bilingual) –––
    // Added a 'prefix' argument to differentiate radio button names between test and practice modes
    function createQuestionElement(qData, prefix = 'q', displayIndex = null) {
      const s = uiStrings[currentLanguage];
      const div = document.createElement('div');
      div.className = 'question-block';
      const actualDisplayIndex = displayIndex !== null ? displayIndex : qData.qNum; // Use provided index or qNum

      div.innerHTML = `
        <p class="text-gray-800 text-base"><b>${actualDisplayIndex}.</b> ${
        qData.text[currentLanguage]
      }</p>
        <div class="mt-3 space-y-2">
          <label class="flex items-center p-2 rounded-md hover:bg-gray-50 transition-colors duration-150">
            <input type="radio" name="${prefix}${qData.qNum}" value="true">
            <span class="ml-3 text-gray-700 true-label">${s.trueLabel}</span>
          </label>
          <label class="flex items-center p-2 rounded-md hover:bg-gray-50 transition-colors duration-150">
            <input type="radio" name="${prefix}${qData.qNum}" value="false">
            <span class="ml-3 text-gray-700 false-label">${s.falseLabel}</span>
          </label>
        </div>
        <p id="${prefix}${qData.qNum}-result" class="result mt-2"></p>
      `;
      return div;
    }

    // ––– Add “Check Answers” Button & Score Placeholder to Page –––
    function addCheckButtonAndScoreToPage(pageIdx) {
      const s = uiStrings[currentLanguage];
      const pageEl = pageElements[pageIdx];
      if (!pageEl) return;

      const startQ = pageIdx * questionsPerPage + 1;
      const endQ = Math.min((pageIdx + 1) * questionsPerPage, allQuizData.length);

      const btn = document.createElement('button');
      btn.onclick = () => checkAnswersForPage(pageIdx, startQ, endQ, true);
      btn.className =
        'check-answers-btn bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg w-full mt-6 shadow-md transition-colors duration-150';
      btn.textContent = `${s.checkAnswersButton} (${s.pageIndicatorPrefix} ${
        pageIdx + 1
      })`;
      pageEl.appendChild(btn);

      const scoreP = document.createElement('p');
      scoreP.id = `score-page-${pageIdx}`;
      scoreP.className =
        'page-score-display text-center font-semibold text-lg mt-4 text-gray-800';
      pageEl.appendChild(scoreP);
    }

    // ––– Update Pagination Controls –––
    function updateNavigation() {
      const s = uiStrings[currentLanguage];
      pageElements.forEach((page, idx) => {
        if (!page) return;
        if (idx === currentPageIndex) {
          page.style.display = 'block';
          page.classList.add('active');
        } else {
          page.style.display = 'none';
          page.classList.remove('active');
        }
      });
      document.getElementById(
        'pageIndicator'
      ).textContent = `${s.pageIndicatorPrefix} ${currentPageIndex + 1} / ${numPages}`;
      document.getElementById('prevButton').disabled =
        currentPageIndex === 0;
      document.getElementById('nextButton').disabled =
        currentPageIndex === numPages - 1;

      // Scroll container into view
      const container = document.querySelector('.container.mx-auto');
      if (container) {
        container.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    function navigatePage(dir) {
      const newIdx = currentPageIndex + dir;
      if (newIdx >= 0 && newIdx < numPages) {
        currentPageIndex = newIdx;
        updateNavigation();
        renderCurrentPageQuestionsAndFeedback();
      }
    }

    // ––– Check Answers for One Page –––
    function checkAnswersForPage(pageIdx, startQ, endQ, calculateScore = true) {
      const s = uiStrings[currentLanguage];
      let score = 0;

      // Determine which slice of quizOrder we are showing on this page:
      const startIdx = pageIdx * questionsPerPage;
      const endIdx = Math.min(startIdx + questionsPerPage, allQuizData.length);
      const questionsOnThisPage = endIdx - startIdx;

      if (calculateScore) {
        pageScores[pageIdx] = {
          score: 0,
          totalQuestions: questionsOnThisPage,
          attempted: true
        };
      }

      // Loop over the indexes in quizOrder for this page
      for (let i = startIdx; i < endIdx; i++) {
        const dataIdx = quizOrder[i];                // actual index into allQuizData
        const qData   = allQuizData[dataIdx];        // { qNum, text: {...}, answer: "true"/"false" }
        const qNumber = qData.qNum;                   // e.g. 1, 2, …, 100

        const resultEl = document.getElementById(`q${qNumber}-result`);
        const radios   = document.getElementsByName(`q${qNumber}`);
        let selectedVal = null;
        radios.forEach(rb => { if (rb.checked) selectedVal = rb.value; });

        if (!resultEl) continue;

        if (selectedVal === null) {
          // No radio selected
          resultEl.textContent = s.selectAnswerPrompt;
          resultEl.className = "result text-red-700";
        }
        else if (selectedVal === qData.answer) {
          // User got it correct
          resultEl.textContent = s.correctFeedback;
          resultEl.className = "result text-green-700";
          if (calculateScore) score++;
        }
        else {
          // User got it wrong
          const correctText = (qData.answer === "true") ? s.trueLabel : s.falseLabel;
          resultEl.textContent = `${s.incorrectFeedbackPrefix}${correctText}.`;
          resultEl.className = "result text-red-700";
        }

        // Only update stats if an answer was given
        if (selectedVal !== null) {
          const wasCorrect = selectedVal === qData.answer;
          // Should be initialized by loadPerformanceData, but as a fallback
          if (!performanceData[qNumber]) {
              performanceData[qNumber] = { qNumOriginal: qNumber, correctAttempts: 0, incorrectAttempts: 0, category: 'unseen', history: [], lastSeenInQuiz: 0 };
          }
          const questionPerf = performanceData[qNumber];

          if (wasCorrect) {
            questionPerf.correctAttempts++;
          } else {
            questionPerf.incorrectAttempts++;
          }
          questionPerf.history.push({ timestamp: Date.now(), correct: wasCorrect });
          if (questionPerf.history.length > 10) questionPerf.history.shift(); // Keep last 10 history items

          updateQuestionCategory(qNumber);
        }
      }

      if (calculateScore && pageScores[pageIdx]) {
        pageScores[pageIdx].score = score;
      }

      const scoreEl = document.getElementById(`score-page-${pageIdx}`);
      if (scoreEl && pageScores[pageIdx]) {
        scoreEl.textContent =
          `${s.scoreForPageLabel}: ${pageScores[pageIdx].score} / ${pageScores[pageIdx].totalQuestions}`;
      }
      savePerformanceData(); // Save after checking all questions on the page
    }

    // ––– Reset All Answers & Scores –––
    function resetAllAnswers() {
      const s = uiStrings[currentLanguage];
      // Use a custom modal for confirmation instead of alert/confirm
      showConfirmationModal(s.confirmResetPerformance, () => {
        allQuizData.forEach((qData) => {
          // Reset test mode radio buttons and feedback
          const radios = document.getElementsByName(`q${qData.qNum}`);
          radios.forEach((rb) => (rb.checked = false));
          const resEl = document.getElementById(`q${qData.qNum}-result`);
          if (resEl) {
            resEl.textContent = '';
            resEl.className = 'result mt-2';
          }
          // Reset practice mode radio buttons and feedback (if any are rendered)
          const pqRadios = document.getElementsByName(`pq${qData.qNum}`);
          pqRadios.forEach((rb) => (rb.checked = false));
          const pqResEl = document.getElementById(`pq${qData.qNum}-result`);
          if (pqResEl) {
            pqResEl.textContent = '';
            pqResEl.className = 'result mt-2';
          }
        });
        pageScores = Array(numPages)
          .fill(null)
          .map(() => ({ score: 0, totalQuestions: 0, attempted: false }));
        for (let i = 0; i < numPages; i++) {
          const scEl = document.getElementById(`score-page-${i}`);
          if (scEl) scEl.textContent = '';
        }

        // Reset performance data
        performanceData = {};
        allQuizData.forEach(qData => {
          performanceData[qData.qNum] = {
            qNumOriginal: qData.qNum,
            correctAttempts: 0,
            incorrectAttempts: 0,
            category: 'unseen',
            history: [],
            lastSeenInQuiz: 0 // Reset last seen counter
          };
        });
        quizCounter = 0; // Reset quiz counter
        savePerformanceData();
        showNotification(s.performanceDataReset, 'success');
        renderCurrentPageQuestionsAndFeedback(); // Re-render current page to clear feedback
      });
    }

    // Custom Confirmation Modal (instead of window.confirm)
    let confirmationModalCallback = null;
    function showConfirmationModal(message, callback) {
        const modal = document.getElementById('customConfirmationModal');
        const modalBody = document.getElementById('confirmationModalBody').querySelector('p');
        modalBody.textContent = message;

        modal.style.display = 'block';

        confirmationModalCallback = callback;

        document.getElementById('confirmYes').onclick = () => {
            if (confirmationModalCallback) confirmationModalCallback();
            closeConfirmationModal();
        };
        document.getElementById('confirmNo').onclick = () => {
            closeConfirmationModal();
        };
    }

    function closeConfirmationModal() {
        document.getElementById('customConfirmationModal').style.display = 'none';
        confirmationModalCallback = null;
    }


    // ––– Show Notification Toast –––
    function showNotification(message, type = 'info') {
      const note = document.getElementById('notificationArea');
      if (!note) return;
      note.textContent = message;
      let bg = 'bg-blue-600';
      if (type === 'success') bg = 'bg-green-600';
      if (type === 'error') bg = 'bg-red-600';
      note.className = `fixed top-5 right-5 p-4 rounded-md shadow-lg z-100 text-white font-medium ${bg}`;
      note.style.display = 'block';
      setTimeout(() => {
        note.style.display = 'none';
      }, 3000);
    }

    // ––– Show Final Results Modal –––
    function showFinalResultsModal() {
      const s = uiStrings[currentLanguage];
      const body = document.getElementById('finalResultsBody');
      body.innerHTML = '';
      let overallAchieved = 0;
      let overallTotal = 0;
      let anyAttempted = false;

      pageScores.forEach((pageScore, idx) => {
        if (pageScore && pageScore.attempted) {
          anyAttempted = true;
          const p = document.createElement('p');
          p.className = 'text-gray-700';
          p.textContent = `${s.pageIndicatorPrefix} ${
            idx + 1
          }: ${pageScore.score} / ${pageScore.totalQuestions}`;
          body.appendChild(p);
          overallAchieved += pageScore.score;
          overallTotal += pageScore.totalQuestions;
        }
      });

      if (!anyAttempted) {
        body.textContent = s.noResultsYet;
        document.getElementById('overallScoreText').textContent = '';
      } else {
        document.getElementById(
          'overallScoreText'
        ).textContent = `${s.overallScoreLabel}: ${overallAchieved} / ${overallTotal}`;
      }
      document.getElementById('finalResultsModal').style.display = 'block';
    }
    function closeFinalResultsModal() {
      document.getElementById('finalResultsModal').style.display = 'none';
    }

    // ––– START OF NEW PERFORMANCE TRACKING AND PRACTICE CARD LOGIC –––

    // Function to initialize or load performance data from localStorage
    function loadPerformanceData() {
      const savedData = localStorage.getItem('quizPerformanceData_v1');
      if (savedData) {
        performanceData = JSON.parse(savedData);
        // Load quizCounter as well
        const savedQuizCounter = localStorage.getItem('quizCounter_v1');
        if (savedQuizCounter) {
            quizCounter = parseInt(savedQuizCounter, 10);
        }
        // Ensure all questions from allQuizData are in performanceData and have new properties
        allQuizData.forEach(qData => {
          if (!performanceData[qData.qNum]) {
            performanceData[qData.qNum] = {
              qNumOriginal: qData.qNum,
              correctAttempts: 0,
              incorrectAttempts: 0,
              category: 'unseen',
              history: [],
              lastSeenInQuiz: 0 // Initialize for new property
            };
          } else {
              // Ensure existing data has lastSeenInQuiz, default to 0 if missing
              if (performanceData[qData.qNum].lastSeenInQuiz === undefined) {
                  performanceData[qData.qNum].lastSeenInQuiz = 0;
              }
              // Re-evaluate category on load in case logic changed
              updateQuestionCategory(qData.qNum);
          }
        });
      } else {
        // Initialize for all questions if no data found
        allQuizData.forEach(qData => {
          performanceData[qData.qNum] = {
            qNumOriginal: qData.qNum,
            correctAttempts: 0,
            incorrectAttempts: 0,
            category: 'unseen',
            history: [],
            lastSeenInQuiz: 0
          };
        });
        quizCounter = 0;
      }
      console.log("Performance data loaded/initialized:", performanceData);
      console.log("Quiz Counter loaded:", quizCounter);
    }

    // Function to save performance data to localStorage
    function savePerformanceData() {
      localStorage.setItem('quizPerformanceData_v1', JSON.stringify(performanceData));
      localStorage.setItem('quizCounter_v1', quizCounter.toString());
      console.log("Performance data saved.");
      console.log("Quiz Counter saved:", quizCounter);
    }

    // Function to update a question's category based on its performance
    function updateQuestionCategory(qNumKey) {
      const stats = performanceData[qNumKey];
      if (!stats) return;

      const totalAttempts = stats.correctAttempts + stats.incorrectAttempts;
      const historyLength = stats.history.length;

      // 1. Catégorie 'unseen' (Non vues)
      if (totalAttempts === 0) {
        stats.category = 'unseen';
        return;
      }

      // Obtenir les 3 dernières tentatives pour une analyse récente
      const recentHistory = stats.history.slice(-3);
      const recentCorrectCount = recentHistory.filter(h => h.correct).length;
      const recentIncorrectCount = recentHistory.length - recentCorrectCount;

      // 2. Catégorie 'problematic' (Problématiques)
      // Si jamais correcte OU si au moins 2 erreurs sur les 3 dernières tentatives
      if (stats.correctAttempts === 0 || (recentIncorrectCount >= 2 && historyLength >= 2)) {
        stats.category = 'problematic';
        return;
      }

      // 3. Catégorie 'mastered' (Maîtrisées)
      // Si au moins 3 bonnes réponses au total, taux >= 85%, ET les 2 dernières étaient correctes
      if (
          stats.correctAttempts >= 3 &&
          (stats.correctAttempts / totalAttempts >= 0.85) &&
          (historyLength >= 2 && stats.history[historyLength - 1].correct === true && stats.history[historyLength - 2].correct === true)
      ) {
        stats.category = 'mastered';
        return;
      }

      // 4. Catégorie 'new-learning' (Nouvelles en apprentissage)
      // Si c'est la première tentative et qu'elle était correcte
      if (totalAttempts === 1 && stats.history[0].correct === true) {
          stats.category = 'new-learning';
          return;
      }

      // 5. Catégorie 'learning' (En apprentissage) - Par défaut pour les autres cas
      stats.category = 'learning';
    }

    // --- Practice Card Functions ---
    function generatePracticeCard() {
      quizCounter++; // Increment quiz counter for tracking last seen questions
      const s = uiStrings[currentLanguage];
      currentPracticeCardQuestions = [];
      const candidates = {
          problematic: [],
          learning: [],
          'new-learning': [], // Include new-learning category
          unseen: [],
          mastered: []
      };

      // Populate candidates based on their category
      allQuizData.forEach(qData => {
        const perf = performanceData[qData.qNum] || { category: 'unseen' };
        if (candidates[perf.category]) {
          candidates[perf.category].push(qData);
        } else {
          candidates.unseen.push(qData); // Fallback
        }
      });

      // Shuffle each category list to get variety
      for (const category in candidates) {
        candidates[category].sort(() => 0.5 - Math.random());
      }

      // Selection logic for 10 questions
      let count = 0;
      const MAX_PROBLEM_Q = Math.ceil(PRACTICE_CARD_SIZE * 0.3); // Up to 30% problematic
      const MAX_LEARNING_Q = Math.ceil(PRACTICE_CARD_SIZE * 0.4); // Up to 40% learning
      const MAX_NEW_Q = Math.ceil(PRACTICE_CARD_SIZE * 0.2); // Up to 20% new learning
      const MAX_MASTERED_Q = Math.ceil(PRACTICE_CARD_SIZE * 0.1); // Up to 10% mastered for review

      // 1. Prioritize Problematic questions
      while (count < PRACTICE_CARD_SIZE && candidates.problematic.length > 0 && currentPracticeCardQuestions.length < MAX_PROBLEM_Q) {
        currentPracticeCardQuestions.push(candidates.problematic.shift());
        count++;
      }

      // 2. Then Learning questions
      while (count < PRACTICE_CARD_SIZE && candidates.learning.length > 0 && currentPracticeCardQuestions.length < (MAX_PROBLEM_Q + MAX_LEARNING_Q)) {
        currentPracticeCardQuestions.push(candidates.learning.shift());
        count++;
      }

      // 3. Introduce New Learning questions gradually
      while (count < PRACTICE_CARD_SIZE && candidates['new-learning'].length > 0 && currentPracticeCardQuestions.length < (MAX_PROBLEM_Q + MAX_LEARNING_Q + MAX_NEW_Q)) {
          currentPracticeCardQuestions.push(candidates['new-learning'].shift());
          count++;
      }

      // 4. Introduce Unseen questions (move to new-learning category once selected)
      while (count < PRACTICE_CARD_SIZE && candidates.unseen.length > 0) {
          const qData = candidates.unseen.shift();
          currentPracticeCardQuestions.push(qData);
          // Mark as 'new-learning' immediately as it's now seen
          performanceData[qData.qNum].category = 'new-learning';
          count++;
      }

      // 5. Fill remaining with Mastered questions (prioritize those not seen recently)
      // Sort mastered by lastSeenInQuiz (ascending) to get older ones first
      candidates.mastered.sort((a, b) => performanceData[a.qNum].lastSeenInQuiz - performanceData[b.qNum].lastSeenInQuiz);
      while (count < PRACTICE_CARD_SIZE && candidates.mastered.length > 0 && currentPracticeCardQuestions.length < (PRACTICE_CARD_SIZE - MAX_MASTERED_Q)) {
          // Only take older mastered questions if they haven't been seen in a while
          const qData = candidates.mastered.shift();
          if (quizCounter - performanceData[qData.qNum].lastSeenInQuiz > 10) { // Example threshold: not seen in last 10 quizzes
              currentPracticeCardQuestions.push(qData);
              count++;
          } else {
              // If not old enough, put it back at the end (or discard if we have enough)
              candidates.mastered.push(qData); // Add back to try later if needed
              if (candidates.mastered.length === 1) break; // Avoid infinite loop if only one left
          }
      }

      // Final shuffle of the selected questions for randomness within the card
      currentPracticeCardQuestions.sort(() => 0.5 - Math.random());

      if (currentPracticeCardQuestions.length === 0) {
        showNotification("Pas assez de questions disponibles pour générer une carte de pratique. Essayez de répondre à plus de questions en mode examen ou réinitialisez vos données.", "info");
        return;
      }

      // Update lastSeenInQuiz for all questions in the generated practice card
      currentPracticeCardQuestions.forEach(qData => {
          performanceData[qData.qNum].lastSeenInQuiz = quizCounter;
      });
      savePerformanceData(); // Save quizCounter and updated lastSeenInQuiz

      renderPracticeCardQuestions(currentPracticeCardQuestions);
      document.getElementById('checkPracticeCardButton').style.display = 'block';
      document.getElementById('practiceCardScoreText').textContent = ''; // Clear previous score
      document.getElementById('generateNewPracticeCardButton').style.display = 'none'; // Hide until checked
    }

    // Renders the practice card questions directly on the page
    function renderPracticeCardQuestions(questionsToRender) {
      const displayArea = document.getElementById('practiceQuestionsDisplayArea');
      displayArea.innerHTML = ''; // Clear previous questions

      questionsToRender.forEach((qData, index) => {
        // Use 'pq' prefix for practice questions to avoid name conflicts with 'q' from test mode
        displayArea.appendChild(createQuestionElement(qData, 'pq', index + 1));
      });
    }

    function checkPracticeCardAnswers() {
      const s = uiStrings[currentLanguage];
      let score = 0;
      let answeredCount = 0;

      currentPracticeCardQuestions.forEach(qData => {
        const radios = document.getElementsByName(`pq${qData.qNum}`); // Use 'pq' prefix
        const resultEl = document.getElementById(`pq${qData.qNum}-result`); // Use 'pq' prefix
        let selectedVal = null;
        radios.forEach(rb => { if (rb.checked) selectedVal = rb.value; });

        if (!resultEl) return;

        if (selectedVal === null) {
          resultEl.textContent = s.selectAnswerPrompt;
          resultEl.className = "result text-red-700";
        } else {
          answeredCount++;
          const wasCorrect = selectedVal === qData.answer;
          if (wasCorrect) {
            score++;
            resultEl.textContent = s.correctFeedback;
            resultEl.className = "result text-green-700";
          } else {
            const correctText = (qData.answer === "true") ? s.trueLabel : s.falseLabel;
            resultEl.textContent = `${s.incorrectFeedbackPrefix}${correctText}.`;
            resultEl.className = "result text-red-700";
          }

          // Update global performance data
          const qNumForPerf = qData.qNum;
          if (!performanceData[qNumForPerf]) {
              performanceData[qNumForPerf] = { qNumOriginal: qNumForPerf, correctAttempts: 0, incorrectAttempts: 0, category: 'unseen', history: [], lastSeenInQuiz: 0 };
          }
          const questionPerf = performanceData[qNumForPerf];
          if (wasCorrect) {
            questionPerf.correctAttempts++;
          } else {
            questionPerf.incorrectAttempts++;
          }
          questionPerf.history.push({ timestamp: Date.now(), correct: wasCorrect });
          if (questionPerf.history.length > 10) questionPerf.history.shift();
          updateQuestionCategory(qNumForPerf);
        }
      });

      if (answeredCount === currentPracticeCardQuestions.length) {
          document.getElementById('practiceCardScoreText').textContent = `${s.scoreForPageLabel}: ${score} / ${currentPracticeCardQuestions.length}`;
          document.getElementById('generateNewPracticeCardButton').style.display = 'block'; // Show new card button
      }

      savePerformanceData(); // Save after checking practice card
    }

    // --- Performance Stats Modal Functions ---
    function showPerformanceStatsModal() {
      const s = uiStrings[currentLanguage];
      const body = document.getElementById('performanceStatsBody');
      body.innerHTML = '';

      const stats = {
        unseen: [], 'new-learning': [], learning: [], mastered: [], problematic: [],
        totalCorrect: 0, totalIncorrect: 0
      };

      allQuizData.forEach(qData => {
        const perf = performanceData[qData.qNum];
        if (perf) {
          stats[perf.category].push(qData);
          stats.totalCorrect += perf.correctAttempts;
          stats.totalIncorrect += perf.incorrectAttempts;
        } else {
          stats.unseen.push(qData); // Should not happen if loadPerformanceData is correct
        }
      });

      const categoryLabels = {
          unseen: s.categoryUnseen,
          'new-learning': s.categoryNewLearning, // New label
          learning: s.categoryLearning,
          mastered: s.categoryMastered,
          problematic: s.categoryProblematic
      };

      // Order for display
      const displayOrder = ['problematic', 'new-learning', 'learning', 'mastered', 'unseen'];

      displayOrder.forEach(category => {
        const detailEl = document.createElement('details');
        detailEl.className = 'category-detail';
        const summaryEl = document.createElement('summary');
        summaryEl.textContent = `${categoryLabels[category]}: ${stats[category].length} ${s.questionsInCategory}`;
        detailEl.appendChild(summaryEl);

        const ulEl = document.createElement('ul');
        if (stats[category].length > 0) {
            // Sort questions by qNum for consistent display within categories
            stats[category].sort((a, b) => a.qNum - b.qNum).forEach(qData => {
                const liEl = document.createElement('li');
                liEl.textContent = `Q${qData.qNum}: ${qData.text[currentLanguage].substring(0, 100)}...`; // Show first 100 chars
                ulEl.appendChild(liEl);
            });
        } else {
            const liEl = document.createElement('li');
            liEl.textContent = "Aucune question dans cette catégorie.";
            ulEl.appendChild(liEl);
        }
        detailEl.appendChild(ulEl);
        body.appendChild(detailEl);
      });


      const divider = document.createElement('hr');
      divider.className = 'my-2';
      body.appendChild(divider);

      const pCorrect = document.createElement('p');
      pCorrect.className = 'text-green-700 font-semibold';
      pCorrect.textContent = `${s.totalCorrect}: ${stats.totalCorrect}`;
      body.appendChild(pCorrect);

      const pIncorrect = document.createElement('p');
      pIncorrect.className = 'text-red-700 font-semibold';
      pIncorrect.textContent = `${s.totalIncorrect}: ${stats.totalIncorrect}`;
      body.appendChild(pIncorrect);

      document.getElementById('performanceStatsModal').style.display = 'block';
    }

    function closePerformanceStatsModal() {
      document.getElementById('performanceStatsModal').style.display = 'none';
    }

    // ––– END OF NEW PERFORMANCE TRACKING AND PRACTICE CARD LOGIC –––

    window.onclick = function (event) {
      if (event.target == document.getElementById('finalResultsModal')) {
        closeFinalResultsModal();
      }
      if (event.target == document.getElementById('performanceStatsModal')) {
        closePerformanceStatsModal();
      }
      // Close custom confirmation modal if clicked outside
      if (event.target == document.getElementById('customConfirmationModal')) {
          closeConfirmationModal();
      }
    };
  </script>
</body>
</html>
